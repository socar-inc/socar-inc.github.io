---
layout: post
title: "React Icon Component 개발기"
subtitle: "React Icon Component 개발기"
date: 2022-07-06 09:00:00 +0900
category: dev
background: "/img/reservation-tetris/background.jpg"
author: sienna, blanc
comments: true
tags:
  - web
  - frontend
  - react
  - design system
---

안녕하세요. 쏘카 웹 프론트엔드 개발자 시에나, 블랑입니다.

이 글에 다룰 내용은 쏘카에서 공통적으로 사용하는 **웹 아이콘 컴포넌트 개발 과정**입니다. 아이콘 컴포넌트를 어떻게 개발했으며 어떤 점들을 개선했는지에 대해서 중점적으로 다룰 예정입니다.

다음과 같은 분들이 읽어보시면 좋을 것 같습니다.

- 웹 프론트엔드 개발자, 웹 디자이너
- 웹 개발에 관심이 있으신 분
- 쏘카 웹프론트엔드 팀이 궁금하신 분

---

## 목차

- [아이콘 컴포넌트 개발 배경](#아이콘-컴포넌트-개발-배경)
  - [기존 방식의 문제점](#기존-방식의-문제점)
  - [개선하고자 한 점](#개선하고자-한-점)
- ## [아이콘 컴포넌트 개발 과정](#아이콘-컴포넌트-개발-과정)
- ## [아이콘 컴포넌트 도입 효과](#아이콘-컴포넌트-도입-효과)
- [추후 개선점](#추후-개선점)
- [마무리](#마무리)

---

## 아이콘 컴포넌트 개발 배경 <a name="아이콘-컴포넌트-개발-배경" />

쏘카의 디자인 시스템은 디자이너, Ios 개발자 Android 개발자, 웹프론트엔드 개발자가 협업하여 구축했습니다. 사용자가 일관된 UI/UX를 경험할 수 있도록 Ios, Android, 웹에서 모두 같은 형태의 컴포넌트들을 개발하여 사용합니다.

이 디자인시스템에 이번 글에서 다룰 아이콘 또한 등록이 되어있었습니다.

_참고: [[SOCAR FRAME 만들기 #1] 쏘카의 디자인 시스템 맛보기](/design/2020/06/23/socar-design-system-01.html)_

### 기존 방식의 문제점 <a name="기존-방식의-문제점" />

기존에는 쏘카에서 아이콘을 폰트로 변환하여 사용하고 있었습니다. 변환 과정을 설명하고 기존 방식이 어떤 문제가 있었는지에 대해 말씀드리겠습니다.

**변환 과정**

1. svg → 웹폰트 변환

   ![image](https://user-images.githubusercontent.com/72717402/177696944-f89f054a-c1e3-4ead-a248-63cbc03376b3.png)

   > 외부 서비스를 이용해서 아이콘 svg 파일들을 웹폰트로 변환합니다.

2. 생성된 파일 등록

   ![image](https://user-images.githubusercontent.com/72717402/177697047-02241121-1daa-4e24-abb3-3ff264c049a9.png)

   ![image](https://user-images.githubusercontent.com/72717402/177697098-8f2beef8-9f3c-4cbd-b0a1-ceb8b3162a30.png)

   > 웹폰트로 변환하면 폰트 파일과 css 파일이 생성됩니다.

   <div style="display: flex; justify-content: space-between;">
       <img width="60%" src="https://user-images.githubusercontent.com/72717402/177697181-5bb3f5f6-49e6-499f-82b5-0bb702a43c75.png" />
       <img width="35%" src="https://user-images.githubusercontent.com/72717402/177697213-24b9d90c-1379-441c-b25f-c808b738c965.png" />
   </div>

   > 생성된 파일들을 디자인 시스템 저장소에 넣어줍니다. 이 때, 폰트에 원하는 컬러를 주입할 수 있도록 하기 위해 css 파일의 color 속성을 제거해줍니다.

3. 디자인시스템 배포
   - 아이콘 폰트 등록이 완료되었으면, 디자인시스템의 배포를 진행합니다. 이 때, 디자인시스템을 사용중인 모든 서비스들도 디자인시스템 버전을 최신화해서 같이 배포를 진행합니다.

**문제점**

기존 방식을 사용하면서 겪은 문제점은 다음과 같습니다.

- 외부 서비스에 의존적이다.

  - 위에서 설명 드렸듯이, svg 파일 -> 웹폰트 변환 과정은 외부 서비스에 전적으로 의존하고 있었습니다. 해당 서비스의 기능이 변경되거나 서비스를 종료하기라도 한다면 기존의 방식으로는 아이콘 등록을 못하게 될 수도 있는 위험성이 있습니다.

- 휴먼에러가 발생할 여지가 많다.

  - 아이콘 등록하는 전 과정을 수기로 진행하고 있었는데, 어느 한 과정이라도 누락하거나 실수가 발생하면 아이콘이 제대로 등록되지 않거나 실 서비스 화면에서 아이콘이 깨져 보이게 됩니다.

- 아이콘 폰트 자체의 문제점
  - 글꼴 파일을 불러오고 빌드하는 시간이 소요된다.
  - 웹 접근성이 좋지 않다.
  - 화면을 확대하면 화질 저하가 발생한다.
  - 텍스트 기반 css 규칙을 따르기 때문에 css 컨트롤이 어렵다.

### 개선하고자 한 점 <a name="개선하고자-한-점" />

위와 같은 문제점들을 겪으면서 디자인시스템에 아이콘을 등록하는 방식 자체를 개선해야겠다고 생각했습니다. 개선의 목표는

- 아이콘 등록 과정의 간소화
- 아이콘 등록 방식의 자동화

정도로 생각하고, 위의 목표를 달성하면서도 기존에 사용중인 아이콘들에 영향을 미치지 않는 방식으로 개선을 시도했습니다.

---

## 3. **아이콘 컴포넌트, 어떻게 만들어졌을까?**

### 3.1 다양한 element 도형을 path element로 변경해보자

svg를 이루는 기본적인 도형들 중에 path element는 여러 개의 직선과 곡선을 합쳐서 **복잡한 도형을 그릴 수 있다는 큰 장점**을 갖고 있습니다. 다양한 element들을 path element 하나로 나타낼 수 있다는 뜻 입니다.

이러한 장점을 이용해 쏘카가 가진 다양한 형태의 아이콘을 하나의 형태로 바꾼다면 컴포넌트화 작업이 수월할 것으로 예상되어 진행하게 됐습니다.

먼저 path element로 바꾸는 원리를
circle element로 작성된 아이콘을 예시로 보여드리겠습니다.

```
<circle cx="6" cy="12" r="4" fill="#374553"/>
```

해당 코드는 (6,12)가 원의 중심이 되고 반지름이 4인 원이 그려집니다. x의 범위는 2~10까지, y의 범위는 8~16까지 점이 찍히게 됩니다.
path element로 나타내면

```
<path d="M2,12 C 2,9.7909, 3.7909,8, 6,8 C 8.2091,8, 10,9.7909, 10,12 C 10,14.2091, 8.2091,16, 6,16 C 3.7909,16, 2,14.2091, 2,12 z">
```

이런 path가 완성됩니다.

M 2,12는 원의 시작점을 뜻합니다. (2,12)에서 시작하여 차례로 점이 찍혀 원을 만들게 됩니다. C는 curve 명령어로 각 점들을 곡선으로 잇게 됩니다. C (x,y), (x,y), (x,y) 이렇게 세개의 좌표가 찍히는데 마지막 좌표는 끝점을 가리키고 앞의 두 좌표는 첫 점과 끝점을 잇는, 곡선을 만드는 점이라고 생각하면 됩니다.
`M2,12 C 2,9.7909, 3.7909,8, 6,8`은 시작점 (2,12)에서 끝점 (6,8)을 잇는데 중간 다리 역할을 하는 것이 (2,9.8), (3.8,8) 이라고 해석할 수 있습니다.
이런 식으로 모든 점을 그려서 잇다보면 circle로 그렸던 원 아이콘을 얻을 수 있습니다.

이런 원리를 식으로 계산하여 circle, rectangle element를 path element로 변환하는 스크립트 파일을 작성하였고, 이 결과물로 아이콘 이름을 key 값으로 갖는 json 파일이 만들어집니다.

```
  "ic12_24_hidden_circle_fill": {
    "width": 12,
    "height": 24,
    "path": "M2,12C2,9.7909,3.7909,8,6,8C8.2091,8,10,9.7909,10,12C10,14.2091,8.2091,16,6,16C3.7909,16,2,14.2091,2,12z"
  },
```

### 3.2 컴포넌트를 만들어서 적용해보자

아이콘의 형태를 동일하게 만들어 하나의 json 파일에 모아두었으니 이걸 활용하여 컴포넌트를 만들어 적용해보겠습니다.
icon 이름, 아이콘 색을 parameter로 받고 svg path로만 이루어진 컴포넌트를 만들어 적용해봤습니다.

```
    <svg
      width={width}
      height={height}
      fill={iconColor}
      fill-rule="evenodd"
      clip-rule="evenodd"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path d={path} />
    </svg>
```

icon component를 사용하려고 보니 문제가 되는 점이 있었습니다.
그것은 바로 IDE가 제공해주는 자동완성이 되지 않는 다는 것이였습니다..!!
아이콘 갯수가 수백개인데 사용할 때마다 일일이 아이콘 이름을 적는 것이 번거로웠고, 이것을 해결해야만 했습니다
이 때 생각한 것이 아이콘 이름을 타입으로 지정하면 IDE의 도움을 받을 수 있을 것이라 예상했습니다.

### 3.3 타입을 적용해보자

타입을 정의하면 컴포넌트를 사용할 때 IDE의 도움을 받아 손쉽게 아이콘의 이름을 정의할 수 있습니다.

아이콘의 이름을 유니온 타입으로 정의하기 위하여 3.1에서 만든 파일에서 아이콘 이름만 추출하는 작업이 필요합니다.
![](/img/icon-component/iconNameJson.png)
3.1에서 만든 파일은 아이콘 이름이 key 값으로 정의되어있기 때문에 key 값만 가져온다면 손쉽게 타입 정의를 할 수 있을 것이라 생각했습니다.
`Object.key()`를 활용해 아이콘 이름을 가져오는 스트립트 파일을 실행했을 때 나오는 결과물입니다.

![](/img/icon-component/iconType.png)

아이콘 이름을 type으로 정의하여 적용하니 컴포넌트를 사용할 때 아이콘 목록이 뜨는 것을 확인할 수 있었습니다.
![](/img/icon-component/iconName.png)

앞서 만들었던 아이콘 json 파일을 읽어 아이콘 이름만 가져오는 스크립트로 명령어를 실행하게 되면 다음과 같은 결과물이 나옵니다.

### 3.4 색상도 타입으로 정의해두면 어떨까~?

아이콘 이름을 유니온 타입으로 정의했듯이 색상도 타입으로 정의하여 IDE의 도움을 받아보고자 지정했습니다.

색상코드가 적힌 css 파일을 문자열 메소드를 이용하여 색상 이름만 가져와 json 파일을 만들어 줍니다.
![](/img/icon-component/iconPaletteCss.png)
![](/img/icon-component/iconPalette.png)

아이콘 색상을 type으로 정의하여 적용하니 컴포넌트를 사용할 때 색상 목록이 뜨는 것을 확인할 수 있었습니다.
![](/img/icon-component/iconColor.png)

색상 값을 추가하거나 변경이 필요하다면 css 파일을 수정하고 스크립트 파일을 실행시키면 해결됩니다.

### 3.5 스크립트 실행을 따로 따로 매번할 수 없잖아??

아이콘이나 색상코드가 추가, 변경될 때마다 실행해야하는 스크립트가 앞서 말했던 path element로 바꾸는 것, 아이콘 이름과 색상 이름을 타입으로 정의하는 것 이렇게 세가지가 있습니다. 세 번의 스크립트를 따로 매번 실행시키기엔 불편한 점이 많아, 자동화시킬 수 있도록 작업하게 됐습니다.

```
"build-icon": "node build/convertSvgPath.js && npm run build-icon-palette && npm run build-icon-type",
"build-icon-palette": "node ./build/iconPalette.js && npm run build-icon-type",
"build-icon-type": "node ./build/iconType.js"
```

명령어 한줄로 스크립트를 실행하여 사용자의 경험을 개선시킬 수 있게 됐습니다.

### 3.6 스토리북에 적용해서 확인해보자

스토리북은 컴포넌트 단위의 UI 개발 환경을 지원하는 도구입니다. 개발한 아이콘 컴포넌트를 출시하기 전에 미리 디자이너, 개발자가 테스트해서 확인할 수 있습니다.
![](/img/icon-component/storybook.png)

이렇게 아이콘과 색을 지정해서 출력해볼 수 있으며, Docs를 확인하여 아이콘 컴포넌트의 사용 방법을 알 수 있으며, 디자이너가 원하는 아이콘이 맞는지 QA도 진행할 수 있습니다.

![](/img/icon-component/storybookTest.png)
![](/img/icon-component/storybookDocs.png)

## 4. **무엇이 달라졌을까?**

### 4.1 기존의 문제점은?

앞서 말했듯이 기존에 발생했던 문제점은 크게 세가지가 있었습니다.

1. 외부 서비스에 의존적이다.
2. 휴먼에러가 발생할 여지가 많다.
3. 아이콘 폰트 자체의 문제점이 있다.

### 4.2 문제점이 해결 되었는가?

자신 있게 문제점이 100% 해결됐다고 말할 수 있습니다.
스크립트 실행을 자동화함으로서 아이콘 등록 전 과정을 자동화할 수 있었고, 수동으로 작성했을 때 발생하는 휴먼 에러를 방지할 수 있다는 점에서 의미있는 작업이었습니다. 또한 외부 서비스를 이용하지 않고 코드 한 줄로 직접 빌드가 가능했고, svg 파일을 사용하게 되어 아이콘 화질 저하 문제, 오래 걸리는 빌드 시간, css 불편함 등이 해결되어 사용성이 개선됐습니다.

---

## 추후 개선점 <a name="추후-개선점" />

- 피드백 받고 추가 예정

- [SVGR](https://react-svgr.com/docs/webpack/) 을 활용해 svg 파일 파싱

![image](https://user-images.githubusercontent.com/72717402/177893564-f4a60a71-90dc-4f7a-bcc3-6ff4a2536c6a.png)

---

## 마무리 <a name="마무리" />
